<div class="history-page">
  <div *ngIf="address" class="title">
    History for address
  </div>

  <div class="title">
    <mat-form-field class="form-input">
      <mat-label class="label-input">Address</mat-label>
      <input matInput type="text" [(ngModel)]="inputAddress">
      <button mat-button *ngIf="inputAddress" matSuffix mat-icon-button aria-label="Clear" (click)="inputAddress=''">
        <mat-icon>close</mat-icon>
      </button>
    </mat-form-field>
    <button mat-mini-fab color="global" *ngIf="this.inputAddress && this.inputAddress != this.address"
            routerLink="/history/{{this.inputAddress?.trim()}}" class="open-button">
      <mat-icon>search</mat-icon>
    </button>
  </div>





  <div class="row stat-row">
    <div *ngIf="address && fullData?.length != 0" class="left-border-box styled-card title-card">
      <div class="">
        Summary: {{tvl() | number: '1.0-0'}}$
      </div>
    </div>

    <div *ngIf="lastFarmHold" class="stat-1 left-border-box styled-card title-card">
      ðŸšœFARM: {{lastFarmHold.ownerBalance | number: '1.0-2'}}
      <mat-checkbox [(ngModel)]="includeFarm" (change)="sortValues()"></mat-checkbox>
    </div>
    <div *ngFor="let c of lps">
      <div class="stat-3 left-border-box styled-card title-card">
        ðŸ’°LP {{c.value}}: {{lastLp.get(c.value).ownerBalanceUsd | number: '1.0-2'}}$
        <mat-checkbox [(ngModel)]="c.checked" (change)="sortValues()"></mat-checkbox>
      </div>
    </div>

    <div *ngFor="let c of vaults">
      <div class="stat-2 left-border-box styled-card title-card">
        <img class="tvl-img" src="{{getImgUrl(c.value)}}" alt="?"/>
        {{prettyVaultName(c.value)}}: {{lastStaked.get(c.value).ownerBalanceUsd | number: '1.0-2'}}$
        <mat-checkbox [(ngModel)]="c.checked"  name="{{c.value}}" (change)="sortValues()"></mat-checkbox>
      </div>
    </div>

  </div>

  <div *ngIf="address" style="text-align: center; font-weight: bolder; color: #4e4e4e">
    It is a beta version, data doesn't include FARM movements and rewards
  </div>

  <div *ngFor="let record of sortedData" >

    <div class="main-row">

      <div class="styled-card box-card row values">
        <div *ngIf="isHarvest(record)" style="width: 100%">
          <app-trade-box [harvestDto]="record"></app-trade-box>
        </div>

        <div *ngIf="isUni(record)" style="width: 100%">
          <app-trade-box [uniswapDto]="record"></app-trade-box>
        </div>
      </div>

    </div>

  </div>

  <div  class="message" *ngIf="address && fullData?.length == 0">
    Address doesn't have any operations
  </div>

  <div class="message" *ngIf="!sortedData">
    <app-loading-spinner></app-loading-spinner>
  </div>

</div>
